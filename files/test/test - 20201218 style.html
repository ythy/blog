 <!DOCTYPE html>
<html>
 <head>
 <meta charset="utf-8" />
 
  <link rel="stylesheet" type="text/css" href="css/yellow.css">
  <style type="text/css">
     div{
        border-style: solid;
        border-width: 2px;
        border-color: red;
     }
  </style>
 </head>

<script>

  const newStyles =  `
    div {
      border-style: solid;
      border-width: 5px;
      border-color: blue;
    }
  `;


  function insertAt(parentElement, newElement, index){
    parentElement.insertBefore(newElement, parentElement.children[index]);
  }

  function clickHandler(index){
    const element = document.createElement('style');
    if(!index && index !== 0)
      document.head.appendChild(element);
    else 
      insertAt(document.head, element, index);

    const sheet = element.sheet;
    sheet.insertRule(newStyles, 0);
  }

  function clickHandlerYellow(index){
    const link  = document.createElement('link');
    link.rel  = 'stylesheet';
    link.type = 'text/css';
    link.href = 'css/yellow.css';

     if(!index && index !== 0)
      document.head.appendChild(link);
    else 
      insertAt(document.head, link, index);
  }

 
</script>	

<div style="width: 200px">
  test
</div>
<div style="float: left; margin-top: 20px"> 
  <button onclick="clickHandler()">changed border color to blue</button>
</div>
<div style="clear:both; float: left; margin-top: 20px"> 
  <button onclick="clickHandler(0)">changed border color to blue AT 0</button>
</div>
<div style="clear:both; float: left; margin-top: 20px"> 
  <button onclick="clickHandlerYellow()">changed border color to yellow</button>
</div>
<div style="clear:both; float: left; margin-top: 20px"> 
  <button onclick="clickHandlerYellow(0)">changed border color to yellow AT 0</button>
</div>
</html>
